ssh {user}@{serverip}
ssh {serverip}                         #uses the client username
ssh -p {portnumber} {user}@{serverip}  #specify the port, 22 is the default

file: ~/.ssh/known_hosts  #stores the servers fingerprint which you connected to before, you can delete it if you want to reset it
file: ~/.ssh/config       #make this file. more servers can be added to this file
	Host {servername}
	  Hostname {serverip}
	  Port {portnumber}
	  User {user}
	  IdentityFile ~/.ssh/{private-keyfile}
	  IdentitiesOnly yes

ssh {servername}  #now you can do this

---------- ssh keys -----------------------------------------------------------
ssh-keygen -b 4096                          #generatig rsa keypairs by default,-b 4096 specifing the size.
ssh-keygen -t ed25519                       #with -t specify what type of key
ssh-keygen -t ed25519 -f ~/.ssh/{filename}  #with -f specify the filename and location.
ssh-keygen -t ed25519 -C {comment}          #adds a comment default is your user and computrname at the end of the file, comment can be changed in file later.

# best keygen practices:
# passphrase is for the private key so if somebody has it they need the passphrase too to use it.
ssh-keygen -t ed25519 -a 100  OR  ssh-keygen -t rsa -b 4096 -o -a 100

# generate the public key form a private key
ssh-keygen -y -e -f {private keyfile}

# add the passphrase to memory:
ps aux | grep ssh-agent              #see if the ssh agent running.
eval "$(ssh-agent)"                  #start the agent. If you logut the terminal the ssh agent is gone!
ssh-add -l                           #list private keys currently accessible to the sshagent
ssh-add ~/.ssh/{private-keyfile}     #add passphrase for private key to ssh agent
ssh-add -d ~/.ssh/{private-keyfile}  #remove passphrase from agent
ssh-add -D                           #remove all key passphrase

ssh -i ~/.ssh/{private-keyfile} {user}@{serverip}  #connect with a specific key. DO THIS IF YOU HAVE MORE THAN 5 KEYS !

# ssh key/file transfer
ssh-copy-id -i ~/.ssh/{keyfile.pub} {user}@{serverip}  #transfers the public key onto the server to the correct location.
OR
cat ~/.ssh/{keyfile.pub} | ssh {user}@{serverip} "mkdir -p ~/.ssh && chmod 700 ~/.ssh && cat >> ~/.ssh/authorized_keys"

---------- scp ----------------------------------------------------------------
scp {localfile} {user}@{serverip}:{path/to}           #copies file from client to server
scp {user}@{serverip}:{path/to/remotefile} {path/to}  #copies file from server to client
scp -r {path/to/folder} {user}@{serverip}:{path/to}   #copies folder to server

---------- ssh server ---------------------------------------------------------
systemctl status sshd       #see if its running, enabled means automatcally starts on startup.
apt install openssh-server  #if you need to install it.
systemctl start sshd
systemctl enable ssh        #starts on boot, on ubuntu and debian its not sshd its ssh!
systemctl stop sshd         #this does not terminates current connections!
systemctl disable sshd      #disable ssh alltogether

# configuration file, make backup before edit!
file: /etc/ssh/sshd_config
     Port 22                    #change it for security
     AddressFamily any          #change to 'inet' to use only ipv4
     PermitRootLogin no         #make sure there is another user!
     PasswordAuthentication no  #set up keyauthentication first!
#allow or deny users, at the end of this file add:
     AllowUsers {user} {user}
     DenyUsers {user} {user}
     AllowGroups {group} {group}
     DenyGroups {group} {group}
sudo systemctl restart sshd

# DO NOT LOCK YOURSELF OUT! DO NOT LOG OUT UNTIL YOU SURE THAT YOU CAN LOG BACK IN!

tail -f /var/log/auth.log  #monitor the connections, good for troubleshooting
OR journalctl -fu ssh      #on some distributions its sshd

# ssh message before login. It really works if you have password login enabled!
file: /etc/ssh/sshd_config
     Banner /etc/issue.net  #remove the comment symbol
file: /etc/issue.net  #edit the message in this file
service ssh restart  OR  /etc/init.d/sshd restart

---------- debug errors -------------------------------------------------------
ssh -v {user}@{serverip}   #for debug information

# hung ssh session window 
press ENTER then ~ then .  #this will terminates the connection

# kill ssh session on server
ps aux | grep sshd:        #first number after the username is the process ID, kill that

# common problem is the file permissions on client are not correct!
  .ssh        drwx------
  privatekey  -rw-------

# help: https://www.ssh.com/academy/ssh
# to-do: send a command via ssh
